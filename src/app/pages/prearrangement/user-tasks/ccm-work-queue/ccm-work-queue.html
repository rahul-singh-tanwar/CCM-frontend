<h2 mat-dialog-title>CCM Work Queue Details</h2>

<div mat-dialog-content>

  <!-- === Eligible Policies === -->
  <section class="section">
    <h3>Eligible Policies</h3>
    <table class="simple-table" *ngIf="data.eligiblePolicies?.length; else noPolicies">
      <thead>
        <tr>
          <th>Company Name</th>
          <th>Policy Type</th>
          <th>Policy Number</th>
          <th>Effective Date</th>
          <th>Expiry Date</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of data.eligiblePolicies">
          <td>{{ p.companyName }}</td>
          <td>{{ p.policyType }}</td>
          <td>{{ p.policyNumber }}</td>
          <td>{{ p.effectiveDate || '-' }}</td>
          <td>{{ p.expiryDate || '-' }}</td>
        </tr>
      </tbody>
    </table>
    <ng-template #noPolicies>
      <p class="muted">No eligible policies available.</p>
    </ng-template>
  </section>

  <!-- === Benefits === -->
    <section class="section">
    <h3>Benefits</h3>

    <div *ngIf="(data?.benefits?.length || 0) > 0; else noBenefits">
      <div class="benefit-card" *ngFor="let ben of data?.benefits">
        <div class="benefit-row">
          <span class="label">Benefit Name:</span>
          <span class="value">{{ ben?.name }}</span>
        </div>
        <div class="benefit-row">
          <span class="label">Limit:</span>
          <span class="value">{{ ben?.limit }}</span>
        </div>
        <div class="benefit-row">
          <span class="label">Remarks:</span>
          <span class="value">{{ ben?.remarks || '-' }}</span>
        </div>
        <hr />
      </div>
    </div>

    <ng-template #noBenefits>
      <p class="muted">No benefit records found.</p>
    </ng-template>
  </section>



  <!-- === Uploaded Documents === -->
  <section class="section">
    <h3>Uploaded Documents</h3>
    <div *ngIf="hasAnyUploaded(); else noUploadFiles">
      <div class="upload-group" *ngIf="data.uploadedDocuments?.formFiles?.length">
        <h4>Form Files</h4>
        <ul>
          <li *ngFor="let f of data.uploadedDocuments?.formFiles">{{ f.originalName }}</li>
        </ul>
      </div>

      <div class="upload-group" *ngIf="data.uploadedDocuments?.labFiles?.length">
        <h4>Lab Files</h4>
        <ul>
          <li *ngFor="let f of data.uploadedDocuments?.labFiles">{{ f.originalName }}</li>
        </ul>
      </div>

      <div class="upload-group" *ngIf="data.uploadedDocuments?.otherFiles?.length">
        <h4>Other Files</h4>
        <ul>
          <li *ngFor="let f of data.uploadedDocuments?.otherFiles">{{ f.originalName }}</li>
        </ul>
      </div>
    </div>
    <ng-template #noUploadFiles>
      <p class="muted">No documents uploaded.</p>
    </ng-template>
  </section>

  <!-- === Customer & Visit Info === -->
  <section class="section two-col">
    <div>
      <h3>Customer Information</h3>
      <p><strong>National ID:</strong> {{ data.customerInfo?.nationalId || '-' }}</p>
      <!-- <p><strong>Policy Number:</strong> {{ data.customerInfo?.policyNumber || '-' }}</p> -->
    </div>
    <div>
      <h3>Visit Information</h3>
      <p><strong>Visit Type:</strong> {{ data.visitInfo?.visitType || '-' }}</p>
      <p><strong>Reservation Type:</strong> {{ data.visitInfo?.reservationType || '-' }}</p>
      <p><strong>ICD10:</strong> {{ data.visitInfo?.ICD10 || '-' }}</p>
      <p><strong>ICD9:</strong> {{ data.visitInfo?.ICD9 || '-' }}</p>
      <p><strong>Admission Date:</strong> {{ data.visitInfo?.AdmissionDate || '-' }}</p>
      <p><strong>Accident Date:</strong> {{ data.visitInfo?.AccidentDate || '-' }}</p>
    </div>
  </section>

  <!-- === Additional Info === -->
  <section class="section">
    <p><strong>Pre-arrangement:</strong> {{ data.prearengment || '-' }}</p>
    <p><strong>Physician License Number:</strong> {{ data.physicianLicenceNumber || '-' }}</p>
    <p><strong>SIMB Amount:</strong> {{ data.silbmAmount || '-' }}</p>
  </section>

</div>

<mat-dialog-actions align="end">
  <button mat-stroked-button (click)="close()">Close</button>
</mat-dialog-actions>
